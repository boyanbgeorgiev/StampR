<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StampR - –ü—Ä–æ–≤–µ—Ä–∫–∞</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="header">
    <nav class="nav">
      <a href="/index.html"><button>–í—Ä–µ–º–µ–≤–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è–≤–∞–Ω–µ</button></a>
      <a href="/hash_search.html"><button class="active">–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª</button></a>
      <a href="about.html"><button>–ó–∞ –Ω–∞—Å</button></a>

      <div class="dropdown" id="userDropdown">
        <button id="dropdownToggle">üë§ –ê–∫–∞—É–Ω—Ç ‚ñæ</button>
        <div class="dropdown-menu" id="dropdownMenu"></div>
      </div>
    </nav>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-text">
      <h1>StampR</h1>
      <p>–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞ —É—Å–ª—É–≥–∞—Ç–∞. –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞ —É—Å–ª—É–≥–∞—Ç–∞.</p>
    </div>
    <div class="hero-icon">
      <img src="timestamp.svg" alt="–ò–∫–æ–Ω–∞ –Ω–∞ –ø–µ—á–∞—Ç" />
    </div>
  </section>

  <!-- Upload/Search Section -->
  <section class="upload-section">
    <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª</h2>
    <div class="layout-wrapper">
      <div class="upload-card">

        <div class="upload-box original" id="originalBox" data-label="–û—Ä–∏–≥–∏–Ω–∞–ª">
          <div class="file-input-wrapper">
            <label for="fileInput">–ö–∞—á–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª</label>
            <span id="fileName">–ù—è–º–∞ –∏–∑–±—Ä–∞–Ω</span>
            <input type="file" id="fileInput" />
          </div>
          <button id="hashButton">–ü—Ä–æ–≤–µ—Ä–∫–∞</button>
          <p id="originalStatus" class="status"></p>
        </div>

        <div class="upload-box serial" id="serialBox" data-label="–°–µ—Ä–∏–µ–Ω –Ω–æ–º–µ—Ä">
          <input type="text" id="serialInput" placeholder="–í—ä–≤–µ–¥–∏ —Å–µ—Ä–∏–µ–Ω –Ω–æ–º–µ—Ä" />
          <button id="searchSerialButton">–ü—Ä–æ–≤–µ—Ä–∫–∞</button>
          <p id="serialStatus" class="status"></p>
        </div>

        <div class="upload-box hash" id="hashBox" data-label="HASH">
          <input type="text" id="hashInput" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –•–µ—à –Ω–∞ —Ñ–∞–π–ª–∞ (SHA‚Äì256)" />
          <button id="searchHashButton">–ü—Ä–æ–≤–µ—Ä–∫–∞</button>
          <p id="hashStatus" class="status"></p>
        </div>

        <div id="timestampResult" class="result-card hidden">
          <h3>–†–µ–∑—É–ª—Ç–∞—Ç</h3>

          <div class="result-row">
            <label>Timestamp</label>
            <div class="result-value copy-wrap">
              <span id="resultTimestamp"></span>
              <button class="copy-btn" data-copy="resultTimestamp" title="–ö–æ–ø–∏—Ä–∞–π">üìã</button>
            </div>
          </div>

          <div class="result-row">
            <label>HASH number</label>
            <div class="result-value copy-wrap">
              <span id="resultHash"></span>
              <button class="copy-btn" data-copy="resultHash" title="–ö–æ–ø–∏—Ä–∞–π">üìã</button>
            </div>
          </div>

          <div class="result-row">
            <label>Serial number</label>
            <div class="result-value copy-wrap">
              <span id="resultSerial"></span>
              <button class="copy-btn" data-copy="resultSerial" title="–ö–æ–ø–∏—Ä–∞–π">üìã</button>
            </div>
          </div>

          <button class="send-button">üì§ –ò–∑–ø—Ä–∞—Ç–∏</button>
        </div>
      </div>
    </div>
  </section>

  <script src="hash_search.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      function getCookie(name) {
        const match = document.cookie.match(new RegExp("(^| )" + name + "=([^;]+)"));
        return match ? decodeURIComponent(match[2]) : null;
      }

      const loggedIn = getCookie("loggedin") === "1";
      const firstName = getCookie("first_name");
      const lastName = getCookie("last_name");
      const fallbackUsername = getCookie("username");
      const toggle = document.getElementById("dropdownToggle");
      const menu = document.getElementById("dropdownMenu");

      if (!toggle || !menu) return;

      if (loggedIn && firstName && lastName) {
        toggle.innerHTML = `–ó–¥—Ä–∞–≤–µ–π, ${firstName} ${lastName} ‚ñæ`;
        menu.innerHTML = `
          <a href="account.php">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</a>
          <a href="logout.php">–ò–∑—Ö–æ–¥</a>
        `;
      } else if (loggedIn && fallbackUsername) {
        toggle.innerHTML = `–ó–¥—Ä–∞–≤–µ–π, ${fallbackUsername} ‚ñæ`;
        menu.innerHTML = `
          <a href="account.php">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</a>
          <a href="logout.php">–ò–∑—Ö–æ–¥</a>
        `;
      } else {
        toggle.innerHTML = "–ê–∫–∞—É–Ω—Ç ‚ñæ";
        menu.innerHTML = `
          <a href="login.html">–í—Ö–æ–¥</a>
          <a href="signup.html">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        `;
      }

      toggle.addEventListener("click", (e) => {
        e.stopPropagation();
        menu.classList.toggle("show");
      });

      document.addEventListener("click", (e) => {
        const dropdown = document.getElementById("userDropdown");
        if (!dropdown.contains(e.target)) {
          menu.classList.remove("show");
        }
      });
    });
  </script>
</body>
</html>
